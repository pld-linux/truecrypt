--- truecrypt-4.2a/Linux/build.sh-orig	2006-10-24 20:32:31.358859750 +0000
+++ truecrypt-4.2a/Linux/build.sh	2006-10-24 20:34:59.416112750 +0000
@@ -15,20 +15,13 @@
 	M="$1/Makefile"
 	[ ! -f "$M" ] && return 1
 	
-	VER=$(grep '^VERSION *=' "$M" | head -n 1 | tr -d ' ' | cut -d'=' -f2)
-	VER=$VER.$(grep '^PATCHLEVEL *=' "$M" | head -n 1 | tr -d ' ' | cut -d'=' -f2)
-	VER=$VER.$(grep '^SUBLEVEL *=' "$M" | head -n 1 | tr -d ' ' | cut -d'=' -f2)
-
-	[ $VER = $(uname -r | cut -d- -f1 | cut -d. -f1-3) ] && return 0
-	return 1
+	return 0
 }
 
 # Prerequisites
 
 echo "Checking build requirements..."
 
-[ $(id -u) -ne 0 ] && error "Administrator (root) privileges required for kernel source configuration." && exit 1
-
 V=""
 case "$(uname -r)" in
 	[01].*) V=1 ;;
@@ -38,25 +31,7 @@
 esac
 [ "$V" ] && error "TrueCrypt requires Linux kernel 2.6.5 or later" && exit 1
 
-KERNEL_SRC=/usr/src/linux-source-$(uname -r)
-check_kernel_version "$KERNEL_SRC" || KERNEL_SRC=/usr/src/linux-source-$(uname -r | cut -d'-' -f1)
-check_kernel_version "$KERNEL_SRC" || KERNEL_SRC=/usr/src/linux-$(uname -r)
-check_kernel_version "$KERNEL_SRC" || KERNEL_SRC=/usr/src/linux-$(uname -r | cut -d'-' -f1)
-check_kernel_version "$KERNEL_SRC" || KERNEL_SRC=/usr/src/linux
-
-if ! check_kernel_version "$KERNEL_SRC"
-then
-	echo -n "Linux kernel ($(uname -r)) source directory [$KERNEL_SRC]: "
-	read A
-	[ "$A" ] && KERNEL_SRC="$A"
-	[ ! -d "$KERNEL_SRC" ] && error "$KERNEL_SRC does not exit" && exit 1
-fi 
-
-if ! check_kernel_version "$KERNEL_SRC"
-then
-	error "Kernel source version in $KERNEL_SRC is not $(uname -r)"
-	exit 1
-fi
+KERNEL_SRC=$1
 
 if [ ! -f "$KERNEL_SRC/drivers/md/dm.h" ]
 then
